# Maintainer: Brian Ngo <mrslime43@gmail.com>
pkgname=dynaswap-bin
pkgver=1.0.0
pkgrel=1
pkgdesc="Dynamic swap management daemon"
arch=('x86_64' 'aarch64')
url="https://github.com/Zarcix/dynaswap"
license=('MIT')
depends=('systemd')
makedepends=('gcc' 'make')
backup=('etc/dynaswap.conf')

source=("$pkgname-$pkgver.tar.gz::$url/archive/$pkgver.tar.gz")
sha256sums=('ab153d5636eb47ced7a3b82a3d9f2efc23f83bd50f9bc39db414480975422941')

source_x86_64=("dynaswap_x86_64")
sha256sums_x86_64=('b8b45e09d318bd0a16f7aab598b3b4b94e1f6904d4aa451cde966e45388486cb')

source_aarch64=("dynaswap_aarch64")
sha256sums_aarch64=('97271b30b602d241c0fa1be3f54e8929d2294ad376766804392dd17c96fac896')

package() {
    cd "$srcdir"

    local make_arch
    make_arch="$(uname -m)"

    # Install the binary
    install -Dm755 "dynaswap_$make_arch" "$pkgdir/usr/bin/dynaswap"

    cd "$srcdir/$pkgname-$pkgver"

    # Install config file
    install -Dm644 "misc/dynaswap.conf" "$pkgdir/etc/dynaswap.conf"

    # Install systemd service
    install -Dm644 "misc/dynaswap.service" "$pkgdir/usr/lib/systemd/system/dynaswap.service"
}
