# Maintainer: Brian Ngo <mrslime43@gmail.com>
pkgname=dynaswap-bin
_pkgrealname=dynaswap
pkgver=1.0.1
pkgrel=1
pkgdesc="Dynamic swap management daemon"
arch=('x86_64' 'aarch64')
url="https://github.com/Zarcix/dynaswap"
license=('MIT')
depends=('systemd')
makedepends=('gcc' 'make')
backup=('etc/dynaswap.conf')

source=("$_pkgrealname-$pkgver.tar.gz::$url/archive/$pkgver.tar.gz")
sha256sums=('53490019ff5e7a3ffa27fc387c7aa2c33797f3d313b27bb8fe44cd769193cd50')

source_x86_64=("dynaswap_x86_64::$url/releases/download/$pkgver/dynaswap_x86_64")
sha256sums_x86_64=('b8b45e09d318bd0a16f7aab598b3b4b94e1f6904d4aa451cde966e45388486cb')

source_aarch64=("dynaswap_aarch64::$url/releases/download/$pkgver/dynaswap_aarch64")
sha256sums_aarch64=('0f087db69a327c0e96e5fa200cf94066cf8aa301e71b90cc4d82202b195390a7')

package() {
    cd "$srcdir"

    local make_arch
    make_arch="$(uname -m)"

    # Install the binary
    install -Dm755 "dynaswap_$make_arch" "$pkgdir/usr/bin/dynaswap"

    cd "$srcdir/$_pkgrealname-$pkgver"

    # Install config file
    install -Dm644 "misc/dynaswap.conf" "$pkgdir/etc/dynaswap.conf"

    # Install systemd service
    install -Dm644 "misc/dynaswap.service" "$pkgdir/usr/lib/systemd/system/dynaswap.service"
}
